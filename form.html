<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>お問い合わせフォーム | せきたん公式サイト</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/style_form.css">
</head>
<body>

  <main class="container">
    <h1>お問い合わせ</h1>
    <form id="contact-form">
      <label>氏名:<br>
        <input type="text" name="name" required>
      </label><br><br>

      <label>メールアドレス:<br>
        <input type="email" name="email" required>
      </label><br><br>

      <label>カテゴリ:<br>
        <select name="category" required>
          <option value="">選択してください</option>
          <option value="ご意見">ご意見</option>
          <option value="不具合">不具合</option>
          <option value="その他">その他</option>
        </select>
      </label><br><br>

      <label>詳細:<br>
        <textarea name="details" required></textarea>
      </label><br><br>

      <button type="submit" id="submit-btn">送信</button>
    </form>

    <p id="response"></p>
  </main>

  <script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbzB9UwDKB8bObPiluAi6eqE9LdGxxhA_XEHS3XzdDoiuQYsE3njMBnWp4cMe5HUhkH-pQ/exec";

  document.getElementById("contact-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    const btn = document.getElementById("submit-btn");
    btn.disabled = true;
    btn.textContent = "送信中…";

    const form = e.target;
    const data = {
      name: form.name.value,
      email: form.email.value,
      category: form.category.value,
      details: form.details.value
    };

    try {
      const res = await fetch(scriptURL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const json = await res.json();

      if (json.success) {
        document.getElementById("response").textContent = 
          `送信完了しました！お問い合わせID: ${json.inquiryId}`;
        form.reset();
      } else {
        document.getElementById("response").textContent = 
          "送信に失敗しました: " + json.error;
      }
    } catch (err) {
      document.getElementById("response").textContent = "通信エラーが発生しました。";
      console.error(err);
    } finally {
      btn.disabled = false;
      btn.textContent = "送信";
    }
  });
  </script>

</body>
</html>
